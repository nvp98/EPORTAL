
@using EPORTAL.ModelsTagSign
@model PagedList.IPagedList<List_Detail_RegisterPeopleValidation>
@using EPORTAL.ModelsPartner;
@using EPORTAL.ModelsView360;
@{
    ViewBag.Title = "PrintTest_View";
    Layout = "~/Views/Shared/PrintView.cshtml";
}
@{
    EPORTALEntities db = new EPORTALEntities();
    EPORTAL_REGISTEREntities db_dk = new EPORTAL_REGISTEREntities();
    EPORTAL_NTEntities dbNT = new EPORTAL_NTEntities();
}
@{
    var DKTN_ID = Convert.ToInt32(ViewData["ID_DKTN"]);
    var ID_DKTN = db_dk.RegisterPeoples.Where(x => x.ID_DKTN == DKTN_ID).FirstOrDefault();
    var ID_NT = db.NT_Partner.Where(x => x.ID == ID_DKTN.NhaThau_ID).FirstOrDefault();
    var ID_PhongBan = db.PhongBans.Where(x => x.IDPhongBan == ID_DKTN.BPQL_ID).FirstOrDefault();
}
<style>
    .button {
        background-color: #05428c;
        border: none;
        color: white;
        padding: 10px 30px;
        text-align: center;
        text-decoration: none;
        display: inline-block;
        font-size: 16px;
        margin: 4px 2px;
        cursor: pointer;
        border-radius: 10px;
    }
</style>
<div class="app-main__outer">
    <div class="app-main__inner" style="display:block;padding:0px;">
        <div class="tab-content">
            <div class="row" style="padding-left: 25px;">
                <div class="card">
                    <div style="flex: 0 0 50%; float: left; max-width: 300px; text-align: center; font-weight: bold; font-size: 1.2rem; text-transform: uppercase;">
                        <img alt="Hòa Phát Dung Quất" src="https://portal.hoaphatdungquat.vn/Content/assets/images/logo-inverse.png" width="90%;" />
                        <span class="" style="margin-top: 0; margin-bottom: 1rem;">Công ty Cổ phần Thép</span>
                        <p class="" style="margin-top: 0; margin-bottom: 1rem;">Hòa Phát Dung Quất</p>

                    </div>
                    @if (ID_DKTN.LoaiNT_ID == 1)
                    {
                        <div class="col-md-6" style="float:right;text-align:right; font-weight: bold; margin-left: auto;">
                            <span>BM.03A/QT.20</span>
                            <p><span style="font-style:italic;">Ngày hiệu lực:</span> 30/11/2024 </p>
                            <p><span style="font-style:italic;">Lần sửa đổi:</span> 02 </p>
                        </div>
                    }
                    else if (ID_DKTN.LoaiNT_ID == 2)
                    {
                        <div class="col-md-6" style="float:right;text-align:right; font-weight: bold; margin-left: auto;">
                            <span>BM.03B/QT.20</span>
                            <p><span style="font-style:italic;">Ngày hiệu lực:</span> 30/11/2024 </p>
                            <p><span style="font-style:italic;">Lần sửa đổi:</span> 02 </p>
                        </div>
                    }
                    else if (ID_DKTN.LoaiNT_ID == 3)
                    {
                        <div class="col-md-6" style="float:right;text-align:right; font-weight: bold; margin-left: auto;">
                            <span>BM.03C/QT.20</span>
                            <p><span style="font-style:italic;">Ngày hiệu lực:</span> 30/11/2024 </p>
                            <p><span style="font-style:italic;">Lần sửa đổi:</span> 02 </p>
                        </div>
                    }

                    <div style="flex: 0 0 100%; max-width: 100%; padding-bottom: 1rem;">
                        <br />
                        <br />
                        <br />
                        <br />
                        <br />

                        @if (ID_DKTN.LoaiNT_ID == 1)
                        {
                            <p style="text-align:center; font-size: 1.5rem;font-weight:bold; text-transform:uppercase;">ĐƠN ĐĂNG KÝ CẤP THẺ DÀI NGÀY CHO NGƯỜI</p>
                        }
                        else if (ID_DKTN.LoaiNT_ID == 2)
                        {
                            <p style="text-align:center; font-size: 1.5rem;font-weight:bold; text-transform:uppercase;">
                                <br />
                                ĐƠN ĐĂNG KÝ CẤP THẺ DÀI NGÀY CHO NGƯỜI <br />
                                APPLICATION FOR LONG STAY ENTRANCE PASS <br />
                                (Dành cho Người nước ngoài/Applicable to Foreigners)
                            </p>
                            <p style="text-align:center; font-size: 1.5rem;font-weight:bold; text-transform:uppercase;"></p>
                            <p style="text-align:center; font-size: 1.5rem;font-weight:bold; text-transform:uppercase;"></p>
                        }
                        else if (ID_DKTN.LoaiNT_ID == 3)
                        {
                            <p style="text-align:center; font-size: 1.5rem;font-weight:bold; text-transform:uppercase;">
                                <br />
                                ĐƠN ĐĂNG KÝ CẤP THẺ DÀI NGÀY CHO NGƯỜI <br />
                                长期入厂工作用的出入证申请单 <br />
                                (Dành cho Người nước ngoài / 适合外国人使用)
                            </p>
                        }

                    </div>

                    @if (ID_DKTN != null)
                    {
                        <div class="col-md-12">
                            <h4 style="margin-bottom: 1%;">
                                Kính gửi: - Công ty Cổ phần Thép Hòa Phát Dung Quất.
                            </h4>
                            <h4 style="margin-bottom: 1%;">
                                Căn cứ theo hợp đồng số: @ID_DKTN.HopDong  giữa Nhà thầu:  @ID_NT.FullName  và Hòa Phát Dung Quất. ( Thời hạn hợp đồng: đến ngày....../....../....... )
                            </h4>
                            <h4 style="margin-bottom: 1%;">
                                Nhà thầu đang thực hiện gói thầu...................................... thời hạn gói thầu từ ngày................. đến ngày.....................do BP:   @ID_PhongBan.TenPhongBan quản lý.
                            </h4>
                            <h4 style="margin-bottom: 1%;">
                                Vì lý do..............................................Để đáp ứng yêu cầu công việc của Nhà thầu,  kính đề nghị đổi/gia hạn/điều chỉnh thông tin thẻ cho những CBNV có tên sau:
                            </h4>
                        </div>
                    }
                    <div class="card-body" style="padding-top: 1%;">
                        <div class="table-responsive">
                            <div>
                                <table class="table table-bordered table-hover" id="table" style="width: 100%; margin-bottom: 1px; background-color: rgba(0, 0, 0, 0); border: 1px solid black !important; color: #000000 !important; text-indent: initial; border-collapse: collapse; " cellpadding="0">
                                    <thead>
                                        <tr>
                                            <th width="50px" rowspan="2" style="vertical-align: middle; text-align: center !important; border: 1px solid black;">STT</th>
                                            <th class="text-center" rowspan="2" width="300px" style="vertical-align: middle; text-align: center !important; border: 1px solid black;">Họ và tên</th>
                                            <th class="text-center" rowspan="2" width="150px" style="vertical-align: middle; text-align: center !important; border: 1px solid black;">Ngày sinh</th>
                                            @if (ID_DKTN.LoaiNT_ID == 1)
                                            {
                                                <th class="text-center" rowspan="2" width="150px" style="vertical-align: middle; text-align: center !important; border: 1px solid black;">CCCD</th>
                                            }
                                            else
                                            {
                                                <th class="text-center" rowspan="2" width="150px" style="vertical-align: middle; text-align: center !important; border: 1px solid black;">Hộ chiếu</th>
                                            }

                                            @if (ID_DKTN.LoaiNT_ID == 1)
                                            {
                                                <th class="text-center" rowspan="2" width="250px" style="vertical-align: middle; text-align: center !important; border: 1px solid black;">Hộ khẩu thường trú</th>
                                            }
                                            else
                                            {
                                                <th class="text-center" rowspan="2" width="250px" style="vertical-align: middle; text-align: center !important; border: 1px solid black;">Quốc tịch</th>
                                            }

                                            <th class="text-center" rowspan="2" width="200px" style="vertical-align: middle; text-align: center !important; border: 1px solid black;">Chức vụ</th>
                                            <th class="text-center" rowspan="2" width="200px" style="vertical-align: middle; text-align: center !important; border: 1px solid black;">Số điện thoại</th>
                                            <th class="text-center" colspan="3" width="200px" style="vertical-align: middle; text-align: center !important; border: 1px solid black;">Thông tin nhà thầu phụ <br /> ( Nếu thuộc NTP )</th>
                                            <th class="text-center" colspan="5" width="200px" style="vertical-align: middle; text-align: center !important; border: 1px solid black;">
                                                Đánh dấu "X" vào
                                                những ô cần chọn
                                            </th>
                                            <th class="text-center" rowspan="2" width="200px" style="vertical-align: middle; text-align: center !important; border: 1px solid black;">Điện thoại di động <br> (Đánh dấu "X" nếu đăng ký)"</th>
                                            <th class="text-center" rowspan="2" width="150px" style="vertical-align: middle; text-align: center !important; border: 1px solid black;">Thời hạn thẻ</th>
                                            <th class="text-center" rowspan="2" width="200px" style="vertical-align: middle; text-align: center !important; border: 1px solid black;">Khu vực làm việc</th>
                                            <th class="text-center" rowspan="2" width="200px" style="vertical-align: middle; text-align: center !important; border: 1px solid black;">Cổng đăng ký ra/vào</th>
                                            <th class="text-center" rowspan="2" width="200px" style="vertical-align: middle; text-align: center !important; border: 1px solid black;">Ghi chú</th>
                                        </tr>

                                        <tr>
                                            <th width="250px" class="text-center" style="text-align: center !important; border: 1px solid black;">Tên NTP</th>
                                            <th width="250px" class="text-center" style="text-align: center !important; border: 1px solid black;">Họ tên quản lý</th>
                                            <th width="100px" class="text-center" style="text-align: center !important; border: 1px solid black;">SĐT quản lý</th>


                                            <th width="70px" class="text-center" style="text-align: center !important; border: 1px solid black;">Cấp mới</th>
                                            <th width="70px" class="text-center" style="text-align: center !important; border: 1px solid black;">Gia hạn</th>
                                            <th width="70px" class="text-center" style="text-align: center !important; border: 1px solid black;">Bổ sung cổng</th>
                                            <th width="70px" class="text-center" style="text-align: center !important; border: 1px solid black;">Cấp lại</th>
                                            <th width="70px" class="text-center" style="text-align: center !important; border: 1px solid black;">Chuyển đổi NT</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        @{
                                            int pageno = (int)Model.PageNumber;
                                            int itemperpage = (int)Model.PageSize;
                                            int RowNo = ((pageno - 1) * itemperpage) + 1;
                                        }
                                        @{

                                            foreach (var item in Model)
                                            {
                                                                                <tr>
                                                                                    <td class="text-center" style="padding-left: 5px; border: 1px solid black;"> @RowNo@{RowNo++;}</td>
                                                                                    <td style="padding-left: 5px; border: 1px solid black;">@item.HoVaTen</td>
                                                                                    <td style="padding-left: 5px; border: 1px solid black;">@item.NgaySinh.ToString("dd-MM-yyyy")</td>
                                                                                    <td style="padding-left: 5px; border: 1px solid black;">@item.CCCD</td>
                                                                                    <td style="padding-left: 5px; border: 1px solid black;">@item.HoKhau</td>
                                                                                    <td style="padding-left: 5px; border: 1px solid black;">
                                                                                        @{
                                                                                            var IDCV = db.NT_Position.Where(x => x.IDCV == item.CV_ID).FirstOrDefault();
                                                                                        }
                                                                                        @IDCV.TenCV.ToString()
                                                                                    </td>
                                                                                    <td style="padding-left: 5px; border: 1px solid black;">
                                                                                        @item.SoDienThoai
                                                                                    </td>
                                                                                    <td style="padding-left: 5px; border: 1px solid black;">
                                                                                        @item.Ten_NTP
                                                                                    </td>
                                                                                    <td style="padding-left: 5px; border: 1px solid black;">
                                                                                        @item.HoTen_QuanLy
                                                                                    </td>
                                                                                    <td style="padding-left: 5px; border: 1px solid black;">
                                                                                        @item.SoDienThoai_QuanLy
                                                                                    </td>
                                                                                    @if (item.CapMoi == "1" || item.CapMoi == "X" || item.CapMoi == "x")
                                                                                    {
                                                                                        <td style="padding-left: 5px; border: 1px solid black;">X</td>
                                                                                    }
                                                                                    else
                                                                                    {
                                                                                        <td style="padding-left: 5px; border: 1px solid black;"></td>
                                                                                    }

                                                                                    @if (item.GiaHan == "2" || item.GiaHan == "X" || item.GiaHan == "x")
                                                                                    {
                                                                                        <td style="padding-left: 5px; border: 1px solid black;">X</td>
                                                                                    }
                                                                                    else
                                                                                    {
                                                                                        <td style="padding-left: 5px; border: 1px solid black;"></td>
                                                                                    }
                                                                                    @if (item.BoSungCong == "3" || item.BoSungCong == "X" || item.BoSungCong == "x")
                                                                                    {
                                                                                        <td style="padding-left: 5px; border: 1px solid black;">X</td>
                                                                                    }
                                                                                    else
                                                                                    {
                                                                                        <td style="padding-left: 5px; border: 1px solid black;"></td>
                                                                                    }
                                                                                    @if (item.CapLai == "4" || item.CapLai == "X" || item.CapLai == "x")
                                                                                    {
                                                                                        <td style="padding-left: 5px; border: 1px solid black;">X</td>
                                                                                    }
                                                                                    else
                                                                                    {
                                                                                        <td style="padding-left: 5px; border: 1px solid black;"></td>
                                                                                    }
                                                                                    @if (item.ChuyenNT == "5" || item.ChuyenNT == "X" || item.ChuyenNT == "x")
                                                                                    {
                                                                                        <td style="padding-left: 5px; border: 1px solid black;">X</td>
                                                                                    }
                                                                                    else
                                                                                    {
                                                                                        <td style="padding-left: 5px; border: 1px solid black;"></td>
                                                                                    }
                                                                                    @if (item.DienThoaiDiDong == 1)
                                                                                    {
                                                                                        <td style="padding-left: 5px; border: 1px solid black;">X</td>
                                                                                    }
                                                                                    else
                                                                                    {
                                                                                        <td style="padding-left: 5px; border: 1px solid black;"></td>
                                                                                    }
                                                                                    <td width="180px" style="padding-left: 5px; border: 1px solid black;">@item.ThoiHanThe.ToString("dd-MM-yyyy")</td>
                                                                                    @{
                                                                                        string ListKhuVuc = "";
                                                                                        string[] arrList = item.KhuVucLamViec.Split(',');
                                                                                        foreach (var ar in arrList)
                                                                                        {
                                                                                            if (ar != "")
                                                                                            {
                                                                                                int IDKV = Convert.ToInt32(ar);
                                                                                                var NameKhuVuc = db.NT_Workplace.Where(x => x.IDKV == IDKV).FirstOrDefault();
                                                                                                ListKhuVuc = String.Concat(NameKhuVuc.TenKV + " , " + ListKhuVuc);
                                                                                            }

                                                                                        }
                                                                                    }
                                                                                    <td style="padding-left: 5px; border: 1px solid black;">
                                                                                        @ListKhuVuc
                                                                                    </td>

                                                                                    @{
                                                                                        string List = "";
                                                                                        string[] arrListStr = item.CongLamViec.Split(',');
                                                                                        foreach (var ar in arrListStr)
                                                                                        {
                                                                                            int IDGate = Convert.ToInt32(ar);
                                                                                            var Cong = db.NT_Gate.Where(x => x.IDGate == IDGate).FirstOrDefault();
                                                                                            List = String.Concat(Cong.Gate + " , " + List);
                                                                                        }
                                                                                    }
                                                                                    <td style="padding-left: 5px; border: 1px solid black;">
                                                                                        @List
                                                                                    </td>
                                                                                    @* <td style="padding-left: 5px; border: 1px solid black;">
            @{
                var IDCong = db.NT_ContractorGroup.Where(x => x.IDGroup == item.NhomNT).FirstOrDefault();
            }
            @IDCong.NameContractorGroup
        </td>*@
                                                                                    <td style="padding-left: 5px; border: 1px solid black;">@item.GhiChu</td>
                                                                                </tr>

                                            }

                                        }

                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-12 pt-3 pull-right" style="margin-top: 1px;margin-right: 150px;">
                        @{
                            DateTime Date = (DateTime)ID_DKTN.NgayTrinhKy;
                        }
                        <label style="font-size:17px;">
                            <i>
                                Ngày @Date.ToString("dd") tháng @Date.ToString("MM") năm @Date.ToString("yyyy")
                            </i>

                        </label>
                    </div>
                    @if (ID_DKTN != null)
                    {
                        if (ID_DKTN.LoaiNT_ID == 1)
                        {
                            // BP trình ký
                            <table style="width: 100%; margin-bottom: 1px; background-color: rgba(0, 0, 0, 0); padding-top:1%;">
                                <thead style="display: table-header-group; vertical-align: middle; border-color: inherit;">
                                    <tr>
                                        <th style="text-align: center !important;" width="20%">Tổ CPT (P.ATMT)</th>
                                        @{
                                            var BPLQ_CD_HT = db_dk.SignOff_Flow.Where(x => x.LuongXuLy == 5 && x.DKTN_ID == ID_DKTN.ID_DKTN).FirstOrDefault();
                                            var BPLQ_CTH_HT = db_dk.SignOff_Flow.Where(x => x.LuongXuLy == 7 && x.DKTN_ID == ID_DKTN.ID_DKTN).FirstOrDefault();
                                            if (BPLQ_CD_HT == null && BPLQ_CTH_HT == null)
                                            {
                                                <th style="text-align: center !important;" width="20%">BP liên quan</th>
                                            }
                                            else if (BPLQ_CD_HT != null && BPLQ_CTH_HT == null)
                                            {
                                                <th style="text-align: center !important;" width="5%">
                                                    @{
                                                        var NV_CD = db.NhanViens.Where(x => x.ID == BPLQ_CD_HT.NhanVienID).FirstOrDefault();
                                                        if (NV_CD != null)
                                                        {

                                                            <img style="width: 100%; padding-bottom: 5%;" src="@Url.Content("~/UploadedFiles/Signature/" + System.IO.Path.GetFileName(NV_CD.Chukychinh))" />
                                                        }
                                                    }
                                                </th>
                                                <th style="text-align: center !important;" width="15%">BP liên quan</th>
                                            }
                                            else if (BPLQ_CD_HT == null && BPLQ_CTH_HT != null)
                                            {
                                                <th style="text-align: center !important;" width="15%">BP liên quan</th>
                                                <th style="text-align: center !important;" width="5%">
                                                    @{
                                                        var NV_CTH = db.NhanViens.Where(x => x.ID == BPLQ_CTH_HT.NhanVienID).FirstOrDefault();
                                                        if (NV_CTH != null)
                                                        {
                                                            <img style="width: 100%; padding-bottom: 5%;" src="@Url.Content("~/UploadedFiles/Signature/" + System.IO.Path.GetFileName(NV_CTH.Chukychinh))" />
                                                        }
                                                    }
                                                </th>
                                            }
                                            else if (BPLQ_CD_HT != null && BPLQ_CTH_HT != null)
                                            {
                                                <th style="text-align: center !important;" width="5%">
                                                    @{
                                                        var NV_CD = db.NhanViens.Where(x => x.ID == BPLQ_CD_HT.NhanVienID).FirstOrDefault();
                                                        if (NV_CD != null)
                                                        {

                                                            <img style="width: 100%; padding-bottom: 5%;" src="@Url.Content("~/UploadedFiles/Signature/" + System.IO.Path.GetFileName(NV_CD.Chukychinh))" />
                                                        }
                                                    }
                                                </th>
                                                <th style="text-align: center !important;" width="10%">BP liên quan</th>
                                                <th style="text-align: center !important;" width="5%">
                                                    @{
                                                        var NV_CTH = db.NhanViens.Where(x => x.ID == BPLQ_CTH_HT.NhanVienID).FirstOrDefault();
                                                        if (NV_CTH != null)
                                                        {
                                                            <img style="width: 100%; padding-bottom: 5%;" src="@Url.Content("~/UploadedFiles/Signature/" + System.IO.Path.GetFileName(NV_CTH.Chukychinh))" />
                                                        }
                                                    }
                                                </th>
                                            }

                                        }

                                        <th style="text-align: center !important;" width="15%"> BP quản lý</th>
                                        <th style="text-align: center !important;" width="5%">
                                            @{
                                                var KTV_KN = db_dk.SignOff_Flow.Where(x => x.LuongXuLy == 1 && x.DKTN_ID == ID_DKTN.ID_DKTN).FirstOrDefault();
                                                if (KTV_KN != null)
                                                {
                                                    var KTV = db.NhanViens.Where(x => x.ID == KTV_KN.NhanVienID).FirstOrDefault();
                                                    <label style="padding-left: 5%;">
                                                        <img style="width: 100%; padding-bottom: 5%;" src="@Url.Content("~/UploadedFiles/Signature/" + System.IO.Path.GetFileName(KTV.Chukynhay))" />
                                                    </label>
                                                }
                                            }
                                        </th>
                                        <th style="text-align: center !important;" width="20%"> Đại diện Nhà thầu</th>
                                    </tr>
                                </thead>
                            </table>

                            // Chữ ký
                            <table style="width: 100%; margin-bottom: 1px; background-color: rgba(0, 0, 0, 0); padding-top:1%;">
                                <thead style="display: table-header-group; vertical-align: middle; border-color: inherit;">
                                    <tr>
                                        <th style="text-align: center !important;" width="20%">
                                            @{
                                                var VP1C_CK = db_dk.SignOff_Flow.Where(x => x.LuongXuLy == 8 && x.DKTN_ID == ID_DKTN.ID_DKTN).FirstOrDefault();
                                                if (VP1C_CK != null)
                                                {
                                                    var NV_VP1C = db.NhanViens.Where(x => x.ID == VP1C_CK.NhanVienID).FirstOrDefault();
                                                    <label>
                                                        <b>
                                                            <img style="width: 50%; padding-bottom: 5%;" src="@Url.Content("~/UploadedFiles/Signature/" + System.IO.Path.GetFileName(NV_VP1C.Chukychinh))" />
                                                        </b>
                                                    </label>
                                                }
                                                else
                                                {
                                                    <label>
                                                        <b>

                                                        </b>
                                                    </label>
                                                }
                                            }
                                        </th>
                                        @{
                                            var BPLQ_CD_CK = db_dk.SignOff_Flow.Where(x => x.LuongXuLy == 5 && x.DKTN_ID == ID_DKTN.ID_DKTN).FirstOrDefault();
                                            var BPLQ_CTH_CK = db_dk.SignOff_Flow.Where(x => x.LuongXuLy == 7 && x.DKTN_ID == ID_DKTN.ID_DKTN).FirstOrDefault();
                                            if (BPLQ_CD_CK == null && BPLQ_CTH_CK == null)
                                            {
                                                <th style="text-align: center !important;" width="20%">

                                                </th>
                                            }
                                            else if (BPLQ_CD_CK != null && BPLQ_CTH_CK == null)
                                            {
                                                <th style="text-align: center !important;" width="20%">
                                                    @{
                                                        var NV_CD = db.NhanViens.Where(x => x.ID == BPLQ_CD_CK.NhanVienID).FirstOrDefault();
                                                        if (NV_CD != null)
                                                        {
                                                            <img style="width: 50%; padding-bottom: 20%;" src="@Url.Content("~/UploadedFiles/Signature/" + System.IO.Path.GetFileName(NV_CD.Chukychinh))" />
                                                        }
                                                    }
                                                </th>
                                            }
                                            else if (BPLQ_CD_CK == null && BPLQ_CTH_CK != null)
                                            {
                                                <th style="text-align: center !important;" width="20%">
                                                    @{
                                                        var NV_CTH = db.NhanViens.Where(x => x.ID == BPLQ_CTH_CK.NhanVienID).FirstOrDefault();
                                                        if (NV_CTH != null)
                                                        {

                                                            <img style="width: 50%; padding-bottom: 5%;" src="@Url.Content("~/UploadedFiles/Signature/" + System.IO.Path.GetFileName(NV_CTH.Chukychinh))" />
                                                        }
                                                    }
                                                </th>
                                            }
                                            else if (BPLQ_CD_CK != null && BPLQ_CTH_CK != null)
                                            {
                                                <th style="text-align: center !important;" width="10%">
                                                    @{
                                                        var NV_CD = db.NhanViens.Where(x => x.ID == BPLQ_CD_CK.NhanVienID).FirstOrDefault();
                                                        if (NV_CD != null)
                                                        {
                                                            <img style="width: 50%; padding-bottom: 5%;" src="@Url.Content("~/UploadedFiles/Signature/" + System.IO.Path.GetFileName(NV_CD.Chukychinh))" />
                                                        }
                                                    }
                                                </th>
                                                <th style="text-align: center !important;" width="10%">
                                                    @{
                                                        var NV_CTH = db.NhanViens.Where(x => x.ID == BPLQ_CTH_CK.NhanVienID).FirstOrDefault();
                                                        if (NV_CTH != null)
                                                        {

                                                            <img style="width: 50%; padding-bottom: 5%;" src="@Url.Content("~/UploadedFiles/Signature/" + System.IO.Path.GetFileName(NV_CTH.Chukychinh))" />
                                                        }
                                                    }
                                                </th>
                                            }

                                        }
                                        <th style="text-align: center !important;" width="20%">
                                            @{
                                                var BPQL_CK = db_dk.SignOff_Flow.Where(x => x.LuongXuLy == 2 && x.DKTN_ID == ID_DKTN.ID_DKTN).FirstOrDefault();
                                                if (BPQL_CK != null)
                                                {
                                                    var NV_BPQL = db.NhanViens.Where(x => x.ID == BPQL_CK.NhanVienID).FirstOrDefault();
                                                    <label>
                                                        <b>
                                                            <img style="width: 50%; padding-bottom: 5%;" src="@Url.Content("~/UploadedFiles/Signature/" + System.IO.Path.GetFileName(NV_BPQL.Chukychinh))" />

                                                        </b>
                                                    </label>
                                                }
                                            }
                                        </th>
                                        <th style="text-align: center !important;" width="20%">
                                            @{
                                                var NV_NT = db_dk.RegisterPeoples.Where(x => x.ID_DKTN == ID_DKTN.ID_DKTN).FirstOrDefault();
                                                var IDNVNT = dbNT.NT_UserTemp.Where(x => x.ID == NV_NT.NhanVienNT_ID).FirstOrDefault();
                                                <label>
                                                    <b>
                                                        <img style="width: 50%; padding-bottom: 5%;" src="@Url.Content("~/UploadedFiles/Signature/" + System.IO.Path.GetFileName(IDNVNT.ChuKy))" />
                                                    </b>
                                                </label>
                                            }
                                        </th>
                                    </tr>
                                </thead>
                            </table>
                            // Họ và tên
                            <table style="width: 100%; margin-bottom: 1px; background-color: rgba(0, 0, 0, 0); padding-top: 1%;">
                                <thead style="display: table-header-group; vertical-align: middle; border-color: inherit;">
                                    <tr>
                                        <th style="text-align: center !important;" width="20%">
                                            @{
                                                var VP1C = db_dk.SignOff_Flow.Where(x => x.LuongXuLy == 8 && x.DKTN_ID == ID_DKTN.ID_DKTN).FirstOrDefault();
                                                if (VP1C != null)
                                                {
                                                    var NV_VP1C = db.NhanViens.Where(x => x.ID == VP1C.NhanVienID).FirstOrDefault();
                                                    <label>
                                                        <b>
                                                            @NV_VP1C.HoTen
                                                        </b>
                                                    </label>
                                                }
                                                else
                                                {
                                                    <label>
                                                        <b>

                                                        </b>
                                                    </label>
                                                }
                                            }
                                        </th>

                                        @{
                                            var BPLQ_CD_T = db_dk.SignOff_Flow.Where(x => x.LuongXuLy == 5 && x.DKTN_ID == ID_DKTN.ID_DKTN).FirstOrDefault();
                                            var BPLQ_CTH_T = db_dk.SignOff_Flow.Where(x => x.LuongXuLy == 7 && x.DKTN_ID == ID_DKTN.ID_DKTN).FirstOrDefault();
                                            if (BPLQ_CD_T == null && BPLQ_CTH_T == null)
                                            {
                                                <th style="text-align: center !important;" width="20%">

                                                </th>
                                            }
                                            else if (BPLQ_CD_T != null && BPLQ_CTH_T == null)
                                            {
                                                <th style="text-align: center !important;" width="20%">
                                                    @{
                                                        var NV_CD = db.NhanViens.Where(x => x.ID == BPLQ_CD_T.NhanVienID).FirstOrDefault();
                                                        if (NV_CD != null)
                                                        {
                                                            @NV_CD.HoTen
                                                        }
                                                    }
                                                </th>
                                            }
                                            else if (BPLQ_CD_T == null && BPLQ_CTH_T != null)
                                            {
                                                <th style="text-align: center !important;" width="20%">
                                                    @{
                                                        var NV_CTH = db.NhanViens.Where(x => x.ID == BPLQ_CTH_T.NhanVienID).FirstOrDefault();
                                                        if (NV_CTH != null)
                                                        {

                                                            @NV_CTH.HoTen
                                                        }
                                                    }
                                                </th>
                                            }
                                            else if (BPLQ_CD_T != null && BPLQ_CTH_T != null)
                                            {
                                                <th style="text-align: center !important;" width="10%">
                                                    @{
                                                        var NV_CD = db.NhanViens.Where(x => x.ID == BPLQ_CD_T.NhanVienID).FirstOrDefault();
                                                        if (NV_CD != null)
                                                        {
                                                            @NV_CD.HoTen
                                                        }
                                                    }
                                                </th>
                                                <th style="text-align: center !important;" width="10%">
                                                    @{
                                                        var NV_CTH = db.NhanViens.Where(x => x.ID == BPLQ_CTH_T.NhanVienID).FirstOrDefault();
                                                        if (NV_CTH != null)
                                                        {

                                                            @NV_CTH.HoTen
                                                        }
                                                    }
                                                </th>
                                            }

                                        }

                                        <th style="text-align: center !important;" width="20%">
                                            @{
                                                var BPQL = db_dk.SignOff_Flow.Where(x => x.LuongXuLy == 2 && x.DKTN_ID == ID_DKTN.ID_DKTN).FirstOrDefault();
                                                if (BPQL != null)
                                                {
                                                    var NV_BPQL = db.NhanViens.Where(x => x.ID == BPQL.NhanVienID).FirstOrDefault();
                                                    <label>
                                                        <b>
                                                            @NV_BPQL.HoTen
                                                        </b>
                                                    </label>
                                                }
                                                else
                                                {
                                                    <label>
                                                        <b>

                                                        </b>
                                                    </label>
                                                }
                                            }
                                        </th>
                                        <th style="text-align: center !important;" width="20%">  Đại diện Nhà thầu</th>
                                    </tr>
                                </thead>
                            </table>

                        }
                        else
                        {
                            // BP trình ký
                            <table style="width: 100%; margin-bottom: 1px; background-color: rgba(0, 0, 0, 0); padding-top:1%;">
                                <thead style="display: table-header-group; vertical-align: middle; border-color: inherit;">
                                    <tr>
                                        <th style="text-align: center !important;" width="20%">Tổ CPT (P.ATMT)</th>
                                        @{
                                            var BPLQ_CD_HT = db_dk.SignOff_Flow.Where(x => x.LuongXuLy == 5 && x.DKTN_ID == ID_DKTN.ID_DKTN).FirstOrDefault();
                                            var BPLQ_CTH_HT = db_dk.SignOff_Flow.Where(x => x.LuongXuLy == 7 && x.DKTN_ID == ID_DKTN.ID_DKTN).FirstOrDefault();
                                            if (BPLQ_CD_HT == null && BPLQ_CTH_HT == null)
                                            {
                                                <th style="text-align: center !important;" width="20%">BP liên quan</th>
                                            }
                                            else if (BPLQ_CD_HT != null && BPLQ_CTH_HT == null)
                                            {
                                                <th style="text-align: center !important;" width="5%">
                                                    @{
                                                        var NV_CD = db.NhanViens.Where(x => x.ID == BPLQ_CD_HT.NhanVienID).FirstOrDefault();
                                                        if (NV_CD != null)
                                                        {

                                                            <img style="width: 100%; padding-bottom: 5%;" src="@Url.Content("~/UploadedFiles/Signature/" + System.IO.Path.GetFileName(NV_CD.Chukychinh))" />
                                                        }
                                                    }
                                                </th>
                                                <th style="text-align: center !important;" width="15%">BP liên quan</th>
                                            }
                                            else if (BPLQ_CD_HT == null && BPLQ_CTH_HT != null)
                                            {
                                                <th style="text-align: center !important;" width="15%">BP liên quan</th>
                                                <th style="text-align: center !important;" width="5%">
                                                    @{
                                                        var NV_CTH = db.NhanViens.Where(x => x.ID == BPLQ_CTH_HT.NhanVienID).FirstOrDefault();
                                                        if (NV_CTH != null)
                                                        {
                                                            <img style="width: 100%; padding-bottom: 5%;" src="@Url.Content("~/UploadedFiles/Signature/" + System.IO.Path.GetFileName(NV_CTH.Chukychinh))" />
                                                        }
                                                    }
                                                </th>
                                            }
                                            else if (BPLQ_CD_HT != null && BPLQ_CTH_HT != null)
                                            {
                                                <th style="text-align: center !important;" width="5%">
                                                    @{
                                                        var NV_CD = db.NhanViens.Where(x => x.ID == BPLQ_CD_HT.NhanVienID).FirstOrDefault();
                                                        if (NV_CD != null)
                                                        {

                                                            <img style="width: 100%; padding-bottom: 5%;" src="@Url.Content("~/UploadedFiles/Signature/" + System.IO.Path.GetFileName(NV_CD.Chukychinh))" />
                                                        }
                                                    }
                                                </th>
                                                <th style="text-align: center !important;" width="10%">BP liên quan</th>
                                                <th style="text-align: center !important;" width="5%">
                                                    @{
                                                        var NV_CTH = db.NhanViens.Where(x => x.ID == BPLQ_CTH_HT.NhanVienID).FirstOrDefault();
                                                        if (NV_CTH != null)
                                                        {
                                                            <img style="width: 100%; padding-bottom: 5%;" src="@Url.Content("~/UploadedFiles/Signature/" + System.IO.Path.GetFileName(NV_CTH.Chukychinh))" />
                                                        }
                                                    }
                                                </th>
                                            }

                                        }
                                        <th style="text-align: center !important;" width="20%"> P.ĐN</th>
                                        <th style="text-align: center !important;" width="15%"> BP quản lý</th>
                                        <th style="text-align: center !important;" width="5%">
                                            @{
                                                var KTV_KN = db_dk.SignOff_Flow.Where(x => x.LuongXuLy == 1 && x.DKTN_ID == ID_DKTN.ID_DKTN).FirstOrDefault();
                                                if (KTV_KN != null)
                                                {
                                                    var KTV = db.NhanViens.Where(x => x.ID == KTV_KN.NhanVienID).FirstOrDefault();
                                                    <label style="padding-left: 5%;">
                                                        <img style="width: 100%; padding-bottom: 5%;" src="@Url.Content("~/UploadedFiles/Signature/" + System.IO.Path.GetFileName(KTV.Chukynhay))" />
                                                    </label>
                                                }
                                            }
                                        </th>
                                        <th style="text-align: center !important;" width="20%"> Đại diện Nhà thầu</th>
                                    </tr>
                                </thead>
                            </table>

                            // Chữ ký
                            <table style="width: 100%; margin-bottom: 1px; background-color: rgba(0, 0, 0, 0); padding-top:1%;">
                                <thead style="display: table-header-group; vertical-align: middle; border-color: inherit;">
                                    <tr>
                                        <th style="text-align: center !important;" width="20%">
                                            @{
                                                var VP1C_CK = db_dk.SignOff_Flow.Where(x => x.LuongXuLy == 8 && x.DKTN_ID == ID_DKTN.ID_DKTN).FirstOrDefault();
                                                if (VP1C_CK != null)
                                                {
                                                    var NV_VP1C = db.NhanViens.Where(x => x.ID == VP1C_CK.NhanVienID).FirstOrDefault();
                                                    <label>
                                                        <b>
                                                            <img style="width: 50%; padding-bottom: 5%;" src="@Url.Content("~/UploadedFiles/Signature/" + System.IO.Path.GetFileName(NV_VP1C.Chukychinh))" />
                                                        </b>
                                                    </label>
                                                }
                                                else
                                                {
                                                    <label>
                                                        <b>

                                                        </b>
                                                    </label>
                                                }
                                            }
                                        </th>
                                        @{
                                            var BPLQ_CD_CK = db_dk.SignOff_Flow.Where(x => x.LuongXuLy == 5 && x.DKTN_ID == ID_DKTN.ID_DKTN).FirstOrDefault();
                                            var BPLQ_CTH_CK = db_dk.SignOff_Flow.Where(x => x.LuongXuLy == 7 && x.DKTN_ID == ID_DKTN.ID_DKTN).FirstOrDefault();
                                            if (BPLQ_CD_CK == null && BPLQ_CTH_CK == null)
                                            {
                                                <th style="text-align: center !important;" width="20%">

                                                </th>
                                            }
                                            else if (BPLQ_CD_CK != null && BPLQ_CTH_CK == null)
                                            {
                                                <th style="text-align: center !important;" width="20%">
                                                    @{
                                                        var NV_CD = db.NhanViens.Where(x => x.ID == BPLQ_CD_CK.NhanVienID).FirstOrDefault();
                                                        if (NV_CD != null)
                                                        {
                                                            <img style="width: 50%; padding-bottom: 20%;" src="@Url.Content("~/UploadedFiles/Signature/" + System.IO.Path.GetFileName(NV_CD.Chukychinh))" />
                                                        }
                                                    }
                                                </th>
                                            }
                                            else if (BPLQ_CD_CK == null && BPLQ_CTH_CK != null)
                                            {
                                                <th style="text-align: center !important;" width="20%">
                                                    @{
                                                        var NV_CTH = db.NhanViens.Where(x => x.ID == BPLQ_CTH_CK.NhanVienID).FirstOrDefault();
                                                        if (NV_CTH != null)
                                                        {

                                                            <img style="width: 50%; padding-bottom: 5%;" src="@Url.Content("~/UploadedFiles/Signature/" + System.IO.Path.GetFileName(NV_CTH.Chukychinh))" />
                                                        }
                                                    }
                                                </th>
                                            }
                                            else if (BPLQ_CD_CK != null && BPLQ_CTH_CK != null)
                                            {
                                                <th style="text-align: center !important;" width="10%">
                                                    @{
                                                        var NV_CD = db.NhanViens.Where(x => x.ID == BPLQ_CD_CK.NhanVienID).FirstOrDefault();
                                                        if (NV_CD != null)
                                                        {
                                                            <img style="width: 50%; padding-bottom: 5%;" src="@Url.Content("~/UploadedFiles/Signature/" + System.IO.Path.GetFileName(NV_CD.Chukychinh))" />
                                                        }
                                                    }
                                                </th>
                                                <th style="text-align: center !important;" width="10%">
                                                    @{
                                                        var NV_CTH = db.NhanViens.Where(x => x.ID == BPLQ_CTH_CK.NhanVienID).FirstOrDefault();
                                                        if (NV_CTH != null)
                                                        {

                                                            <img style="width: 50%; padding-bottom: 5%;" src="@Url.Content("~/UploadedFiles/Signature/" + System.IO.Path.GetFileName(NV_CTH.Chukychinh))" />
                                                        }
                                                    }
                                                </th>
                                            }

                                        }
                                        <th style="text-align: center !important;" width="20%">
                                            @{
                                                var HCDN_CK = db_dk.SignOff_Flow.Where(x => x.LuongXuLy == 3 && x.DKTN_ID == ID_DKTN.ID_DKTN).FirstOrDefault();
                                                if (HCDN_CK != null)
                                                {
                                                    var NV_HCDN = db.NhanViens.Where(x => x.ID == HCDN_CK.NhanVienID).FirstOrDefault();
                                                    <label>
                                                        <b>
                                                            <img style="width: 50%; padding-bottom: 5%;" src="@Url.Content("~/UploadedFiles/Signature/" + System.IO.Path.GetFileName(NV_HCDN.Chukychinh))" />

                                                        </b>
                                                    </label>
                                                }
                                            }

                                        </th>
                                        <th style="text-align: center !important;" width="20%">
                                            @{
                                                var BPQL_CK = db_dk.SignOff_Flow.Where(x => x.LuongXuLy == 2 && x.DKTN_ID == ID_DKTN.ID_DKTN).FirstOrDefault();
                                                if (BPQL_CK != null)
                                                {
                                                    var NV_BPQL = db.NhanViens.Where(x => x.ID == BPQL_CK.NhanVienID).FirstOrDefault();
                                                    <label>
                                                        <b>
                                                            <img style="width: 50%; padding-bottom: 5%;" src="@Url.Content("~/UploadedFiles/Signature/" + System.IO.Path.GetFileName(NV_BPQL.Chukychinh))" />

                                                        </b>
                                                    </label>
                                                }
                                            }
                                        </th>
                                        <th style="text-align: center !important;" width="20%">
                                            @{
                                                var NV_NT = db_dk.RegisterPeoples.Where(x => x.ID_DKTN == ID_DKTN.ID_DKTN).FirstOrDefault();
                                                var IDNVNT = dbNT.NT_UserTemp.Where(x => x.ID == NV_NT.NhanVienNT_ID).FirstOrDefault();
                                                <label>
                                                    <b>
                                                        <img style="width: 50%; padding-bottom: 5%;" src="@Url.Content("~/UploadedFiles/Signature/" + System.IO.Path.GetFileName(IDNVNT.ChuKy))" />
                                                    </b>
                                                </label>
                                            }
                                        </th>
                                    </tr>
                                </thead>
                            </table>
                            // Họ và tên
                            <table style="width: 100%; margin-bottom: 1px; background-color: rgba(0, 0, 0, 0); padding-top: 1%;">
                                <thead style="display: table-header-group; vertical-align: middle; border-color: inherit;">
                                    <tr>
                                        <th style="text-align: center !important;" width="20%">
                                            @{
                                                var VP1C = db_dk.SignOff_Flow.Where(x => x.LuongXuLy == 8 && x.DKTN_ID == ID_DKTN.ID_DKTN).FirstOrDefault();
                                                if (VP1C != null)
                                                {
                                                    var NV_VP1C = db.NhanViens.Where(x => x.ID == VP1C.NhanVienID).FirstOrDefault();
                                                    <label>
                                                        <b>
                                                            @NV_VP1C.HoTen
                                                        </b>
                                                    </label>
                                                }
                                                else
                                                {
                                                    <label>
                                                        <b>

                                                        </b>
                                                    </label>
                                                }
                                            }
                                        </th>

                                        @{
                                            var BPLQ_CD_T = db_dk.SignOff_Flow.Where(x => x.LuongXuLy == 5 && x.DKTN_ID == ID_DKTN.ID_DKTN).FirstOrDefault();
                                            var BPLQ_CTH_T = db_dk.SignOff_Flow.Where(x => x.LuongXuLy == 7 && x.DKTN_ID == ID_DKTN.ID_DKTN).FirstOrDefault();
                                            if (BPLQ_CD_T == null && BPLQ_CTH_T == null)
                                            {
                                                <th style="text-align: center !important;" width="20%">

                                                </th>
                                            }
                                            else if (BPLQ_CD_T != null && BPLQ_CTH_T == null)
                                            {
                                                <th style="text-align: center !important;" width="20%">
                                                    @{
                                                        var NV_CD = db.NhanViens.Where(x => x.ID == BPLQ_CD_T.NhanVienID).FirstOrDefault();
                                                        if (NV_CD != null)
                                                        {
                                                            @NV_CD.HoTen
                                                        }
                                                    }
                                                </th>
                                            }
                                            else if (BPLQ_CD_T == null && BPLQ_CTH_T != null)
                                            {
                                                <th style="text-align: center !important;" width="20%">
                                                    @{
                                                        var NV_CTH = db.NhanViens.Where(x => x.ID == BPLQ_CTH_T.NhanVienID).FirstOrDefault();
                                                        if (NV_CTH != null)
                                                        {

                                                            @NV_CTH.HoTen
                                                        }
                                                    }
                                                </th>
                                            }
                                            else if (BPLQ_CD_T != null && BPLQ_CTH_T != null)
                                            {
                                                <th style="text-align: center !important;" width="10%">
                                                    @{
                                                        var NV_CD = db.NhanViens.Where(x => x.ID == BPLQ_CD_T.NhanVienID).FirstOrDefault();
                                                        if (NV_CD != null)
                                                        {
                                                            @NV_CD.HoTen
                                                        }
                                                    }
                                                </th>
                                                <th style="text-align: center !important;" width="10%">
                                                    @{
                                                        var NV_CTH = db.NhanViens.Where(x => x.ID == BPLQ_CTH_T.NhanVienID).FirstOrDefault();
                                                        if (NV_CTH != null)
                                                        {

                                                            @NV_CTH.HoTen
                                                        }
                                                    }
                                                </th>
                                            }

                                        }
                                        <th style="text-align: center !important;" width="20%">
                                            @{
                                                var HCĐN = db_dk.SignOff_Flow.Where(x => x.LuongXuLy == 3 && x.DKTN_ID == ID_DKTN.ID_DKTN).FirstOrDefault();
                                                if (HCĐN != null)
                                                {
                                                    var NV_HCĐN = db.NhanViens.Where(x => x.ID == HCĐN.NhanVienID).FirstOrDefault();
                                                    <label>
                                                        <b>
                                                            @NV_HCĐN.HoTen
                                                        </b>
                                                    </label>
                                                }
                                                else
                                                {
                                                    <label>
                                                        <b>

                                                        </b>
                                                    </label>
                                                }
                                            }
                                        </th>
                                        <th style="text-align: center !important;" width="20%">
                                            @{
                                                var BPQL = db_dk.SignOff_Flow.Where(x => x.LuongXuLy == 2 && x.DKTN_ID == ID_DKTN.ID_DKTN).FirstOrDefault();
                                                if (BPQL != null)
                                                {
                                                    var NV_BPQL = db.NhanViens.Where(x => x.ID == BPQL.NhanVienID).FirstOrDefault();
                                                    <label>
                                                        <b>
                                                            @NV_BPQL.HoTen
                                                        </b>
                                                    </label>
                                                }
                                                else
                                                {
                                                    <label>
                                                        <b>

                                                        </b>
                                                    </label>
                                                }
                                            }
                                        </th>
                                        <th style="text-align: center !important;" width="20%">  Đại diện Nhà thầu</th>
                                    </tr>
                                </thead>
                            </table>
                        }
                    }

                    <div class="col-md-12 pt-5" style="width: 100%; padding-top: 3%;">
                        <div>
                            @if (ID_DKTN.LoaiNT_ID == 1)
                            {
                                <p>
                                    <b>
                                        Ghi chú:
                                    </b> <br />

                                    1. NĐUQ/T/PBP liên quan chỉ ký duyệt trong trường hợp CBNV NT có nhu cầu đăng ký ra vào Cảng thường xuyên;<br />
                                    2. Đại diện Nhà thầu cũ ký trong trường hợp chuyển đổi CBNV giữa các Nhà thầu.<br />
                                    3. Trường hợp CBNV thuộc Nhà thầu phụ (NTP) trực tiếp của Nhà thầu, yêu cầu điền đầy đủ thông tin của NTP.<br />
                                    4. Trường hợp cấp lại thẻ khi thẻ cũ đang còn hạn, chỉ ký đến Nhà thầu và Tổ CPT.<br />

                                </p>
                            }
                            else if (ID_DKTN.LoaiNT_ID == 2)
                            {
                                <p>
                                    <b>
                                        Ghi chú/Remarks:
                                    </b><br />

                                    1. NĐUQ/T/PBP liên quan chỉ ký duyệt trong trường hợp CBNV NT có nhu cầu đăng ký ra vào Cảng thường xuyên;<br />
                                    The relevant department manager/vice manager/the authorized person only to sign and approve in cases where contractor employees need to register to enter and leave the Port regularly<br />
                                    2. Đại diện Nhà thầu cũ ký trong trường hợp chuyển đổi CBNV giữa các Nhà thầu.<br />
                                    Representative of the former Contractor to sign in case of employee transfer between Contractors.<br />
                                </p>
                            }
                            else if (ID_DKTN.LoaiNT_ID == 3)
                            {
                                <p>
                                    <b>
                                        Ghi chú 备注:
                                    </b> <br />

                                    1. NĐUQ/T/PBP liên quan chỉ ký duyệt trong trường hợp CBNV NT có nhu cầu đăng ký ra vào Cảng thường xuyên;<br />
                                    相关部门领导/公司高管只针对承包商干部人员经常需要出入码头区域进行签名批准。<br />
                                    2. Đại diện Nhà thầu cũ ký trong trường hợp chuyển đổi CBNV giữa các Nhà thầu.<br />
                                    旧承包商代表在干部人员换岗到新单位签名确认。<br />
                                </p>
                            }
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>


